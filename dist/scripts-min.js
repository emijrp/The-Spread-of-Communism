$.ajax({type:"GET",url:"../assets/country_codes.json",dataType:"text",success:function(a){country_codes=JSON.parse(a)}}),$.ajax({type:"GET",url:"../assets/data.csv",dataType:"text",success:function(a){csv=a}});var country_codes,csv,map=L.map("map",{minZoom:2,maxZoom:8}).setView([51.505,-.09],13);function getNameFromCode(a){for(var e=0;e<country_codes.length;e++)if(country_codes[e].code==a)return country_codes[e].name;return null}map.setZoom(2),map.panTo(new L.LatLng(25,0)),map.setMaxBounds([[72.5,225],[-37.5,-225]]),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}",{attribution:'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',id:"mapbox.light",accessToken:"pk.eyJ1IjoiamVmZnJleXNoZW5jYyIsImEiOiJjamE5MDI4YmowMmMzMndzNDdoZmZnYzF5In0.zV3f0WhqbHeyixwY--TyZg"}).addTo(map),$.ajax({dataType:"json",url:"../assets/countries.geo.json",success:function(a){for(;!country_codes;);var e=L.geoJSON(a,{style:{fillColor:"#e74c3c",color:"#e74c3c",weight:1,fillOpacity:0,opacity:0}}).bindTooltip(function(a){return getNameFromCode(a.feature.properties.A3)},{sticky:!0}).addTo(map);for(updateDisplay();!csv;);startVisualization(e)}});var year=1917,paused=!1,speed=400;function goBack(){year>1917&&year--,updateDisplay()}function goForward(){year<2017?year++:paused=!0,updateDisplay()}function pause(){paused=!paused,updateDisplay()}function updateDisplay(){$("#year").text(year),$("#playpause").html("<i class = 'fas fa-fw fa-"+(paused?"play":"pause")+"'></i>")}function startVisualization(a){setInterval(function(){paused||($("#killfeed p").append("<span data-year = '"+year+"'>"+year+": <br></span>"),goForward()),$("#killfeed p span").each(function(){$(this).data().year-year>0?$(this).remove():$(this).data().year-year<=-3&&$(this).fadeOut(function(){$(this).remove()})})},speed)}